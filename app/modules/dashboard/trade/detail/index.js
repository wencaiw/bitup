/**
 * Created by Hajay on 2018/1/2.
 */

module.exports = {
    url: '/detail',
    views: {
        'trade': {
            template: __inline('index.html'),
            controller: ['$scope', '$http', '$cookies', '$state', '$', 'line', '$translate', 'T', function($scope, $http, $cookies, $state, $, line, $translate, T){
                //console.log((Math.floor(Math.random()*900)) + 100);
                $scope.g.currPage = 'tradeCenter';

                var arr =[];
                $scope.info = {
                    line : new line.chart(),
                    currTab: 30,   //当前tab
                    randNum: function(num){
                        var currArr = arr.slice(-24 * num);
                        $scope.info.line.yMin(Math.floor(currArr[0]));
                        switch (num){
                            case 1:
                                $scope.info.line.tickInterval(3600000*3);
                                //for(var i=0; i<24; i++){
                                //    arr.push((Math.floor(Math.random()*5)) + 4);
                                //}
                                return currArr;
                                break;
                            case 7:
                                $scope.info.line.tickInterval(3600000*24);
                                //for(var i=0; i<168; i++){
                                //    arr.push((Math.floor(Math.random()*6)) + 3);
                                //}
                                return currArr;
                                break;
                            case 30:
                                $scope.info.line.tickInterval(3600000*24*5);
                                //for(var i=0; i<720; i++){
                                //    arr.push((Math.floor(Math.random()*8)) + 1);
                                //}
                                return currArr;
                                break;
                            default:
                                break;
                        }
                    },
                    getStartDate: function(num){
                        var startDate = new Date();
                        //startDate.setDate(startDate.getDate() - 1);
                        return Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate()-num, startDate.getHours()+1);
                    },
                    switchTab: function(num){
                        if(num != $scope.info.currTab){
                            $scope.info.currTab = num;
                            $scope.info.line.startDate($scope.info.getStartDate(num));
                            $scope.info.line.yList($scope.info.randNum(num));
                        }
                    },
                    goState: function(type){  //buy:买入 sold:卖出 detail:详情
                        $state.go('trade.order', {type: type});
                    }
                };
                $http.get("/app/modules/dashboard/trade/data/dac.list.php").then(function (res) {
                    if (res.data.resultCode == 0) {
                        console.log(res);
                        arr = [1.1452,1.1567,1.1638,1.1693,1.1501,1.1679,1.1783,1.1765,1.1829,1.19,1.1978,1.1989,1.2009,1.211,1.2187,1.2188,1.2123,1.2088,1.2099,1.21,1.2188,1.2132,1.219,1.2178,1.2107,1.2215,1.2288,1.2216,1.2298,1.2199,1.2167,1.2276,1.2265,1.2212,1.23,1.2299,1.2288,1.23,1.2316,1.2354,1.2378,1.2378,1.2361,1.2371,1.2467,1.2765,1.2309,1.2802,1.2765,1.2654,1.281,1.2819,1.2276,1.2903,1.3296,1.3098,1.3245,1.3387,1.2845,1.2201,1.1175,1.1908,1.2654,1.3276,1.3298,1.3376,1.3409,1.3512,1.3309,1.3287,1.3367,1.3412,1.3452,1.3567,1.3638,1.3693,1.3501,1.3679,1.3783,1.3765,1.3829,1.39,1.3978,1.3989,1.3009,1.311,1.3187,1.3188,1.3123,1.3088,1.3099,1.31,1.3188,1.3132,1.319,1.3178,1.3567,1.3599,1.3412,1.3721,1.3623,1.3689,1.3701,1.3706,1.3842,1.3851,1.3812,1.3809,1.3802,1.3976,1.3902,1.3976,1.3911,1.4211,1.4277,1.4198,1.4009,1.4113,1.4188,1.4205,1.4388,1.4327,1.4429,1.421,1.4277,1.4385,1.4329,1.4109,1.4432,1.4419,1.432,1.4399,1.4418,1.4427,1.4491,1.4598,1.4627,1.4611,1.4721,1.4722,1.462,1.4711,1.4761,1.4933,1.4321,1.4399,1.4722,1.2906,1.3921,1.4855,1.4983,1.5319,1.511,1.5318,1.5217,1.5344,1.5432,1.5487,1.5518,1.5643,1.5311,1.5296,1.5511,1.521,1.5547,1.5639,1.5723,1.5899,1.5452,1.5567,1.5638,1.5693,1.5501,1.5679,1.5783,1.5765,1.5829,1.59,1.5978,1.5989,1.6009,1.611,1.6187,1.6188,1.6123,1.6088,1.6099,1.61,1.6188,1.6132,1.619,1.6178,1.6388,1.6327,1.6429,1.621,1.6277,1.6385,1.6329,1.6109,1.6432,1.6419,1.632,1.6399,1.6418,1.6427,1.6491,1.6598,1.6627,1.6611,1.6721,1.6722,1.662,1.6711,1.6761,1.6933,1.6567,1.6599,1.6412,1.6721,1.6623,1.6689,1.6701,1.6706,1.6842,1.6851,1.6812,1.6809,1.6802,1.6976,1.6902,1.6976,1.6911,1.7211,1.7277,1.7198,1.7009,1.7113,1.7188,1.7205,1.7452,1.7567,1.7638,1.7693,1.7501,1.7679,1.7783,1.7765,1.7829,1.79,1.7978,1.7989,1.7009,1.711,1.7187,1.7188,1.7123,1.7088,1.7099,1.71,1.7188,1.7132,1.719,1.7178,1.7388,1.7327,1.7429,1.721,1.7277,1.7385,1.7329,1.7109,1.7432,1.7419,1.732,1.7399,1.7418,1.7427,1.7491,1.7598,1.7627,1.7611,1.7721,1.7722,1.762,1.7711,1.7761,1.7933,1.7654,1.7632,1.7592,1.6799,1.6542,1.6643,1.6811,1.5321,1.5933,1.5877,1.5543,1.5681,1.4911,1.5219,1.4651,1.4688,1.4721,1.493,1.5631,1.5321,1.5513,1.5703,1.5744,1.5811,1.5567,1.5599,1.5412,1.5721,1.5623,1.5689,1.5701,1.5706,1.5842,1.5851,1.5812,1.5809,1.5802,1.5976,1.5902,1.5976,1.5911,1.6211,1.6277,1.6198,1.6009,1.6113,1.6188,1.6205,1.5452,1.5567,1.5638,1.5693,1.5501,1.5679,1.5783,1.5765,1.5829,1.59,1.5978,1.5989,1.6009,1.611,1.6187,1.6188,1.6123,1.6088,1.6099,1.61,1.6188,1.6132,1.619,1.6178,1.6388,1.6327,1.6429,1.621,1.6277,1.6385,1.6329,1.6109,1.6432,1.6419,1.632,1.6399,1.6418,1.6427,1.6491,1.6598,1.6627,1.6611,1.6721,1.6722,1.662,1.6711,1.6761,1.6933,1.6875,1.7191,1.744,1.7633,1.7567,1.7166,1.7231,1.7319,1.7411,1.6819,1.6211,1.591,1.5992,1.6116,1.6254,1.5231,1.5822,1.6399,1.7419,1.7674,1.7722,1.7965,1.8488,1.8564,1.9513,1.7977,1.681,1.7199,1.7218,1.7311,1.7452,1.7322,1.7565,1.7521,1.7599,1.7511,1.7654,1.7698,1.7532,1.7655,1.7713,1.7789,1.7854,1.7411,1.7512,1.7622,1.7711,1.765,1.7388,1.7327,1.7429,1.721,1.7277,1.7385,1.7329,1.7109,1.7432,1.7419,1.732,1.7399,1.7418,1.7427,1.7491,1.7598,1.7627,1.7611,1.7721,1.7722,1.762,1.7711,1.7761,1.7933,1.7452,1.7567,1.7638,1.7693,1.7501,1.7679,1.7783,1.7765,1.7829,1.79,1.7978,1.7989,1.8009,1.811,1.8187,1.8188,1.8123,1.8088,1.8099,1.81,1.8188,1.8132,1.819,1.8178,1.9388,1.8327,1.8429,1.821,1.9277,1.8591,1.8329,1.8409,1.8532,1.8619,1.872,1.8899,1.8918,1.9427,1.8491,1.7598,1.8627,1.9611,1.9721,1.8722,2.062,2.1111,1.8761,1.8933,1.8665,1.8655,1.862,1.8699,1.8711,1.8723,1.8754,1.8765,1.8795,1.8745,1.7908,1.8432,1.8513,1.8567,1.8677,1.8654,1.8613,1.8691,1.8713,1.8743,1.8725,1.8756,1.8719,1.8711,1.9567,1.9599,1.9412,1.9721,1.9623,1.9689,1.9701,1.9706,1.9842,1.9851,1.9812,1.9809,1.9802,1.9976,1.9902,1.9976,1.9911,1.9211,1.9277,1.9198,1.9009,1.9113,1.9188,1.9205,1.9513,1.8977,1.881,1.9199,1.9218,1.9311,1.9452,1.9322,1.9565,1.9521,1.9599,2.0511,2.0654,2.0698,2.0532,2.0655,2.0713,2.0789,2.0854,2.0411,2.0512,2.0622,2.0711,2.065,2.0533,2.0532,2.0433,2.0395,2.0355,2.0416,2.0526,2.0522,2.0518,2.0567,2.0614,2.0681,2.0654,2.0722,2.0713,1.9711,1.9765,1.9801,1.9755,1.9532,1.9677,1.9614,1.9674,1.9655,2.1388,2.1327,2.1429,2.121,2.1277,2.1385,2.1329,2.1109,2.1432,2.1419,2.132,2.1399,2.1418,2.1427,2.1491,2.1598,2.1627,2.1611,2.1721,2.1722,2.162,2.1711,2.1761,2.1933,2.1877,2.1854,2.1911,2.1917,2.1954,2.1987,2.1917,2.1504,2.1708,2.1766,2.1641,2.154,1.9439,1.9322,1.9311,1.9345,1.9318,1.9379,1.9566,1.9543,2.2617,2.2611,2.2543,2.2411,2.2567,2.2599,2.2412,2.2721,2.2623,2.2689,2.2701,2.2706,2.2842,2.2851,2.2812,2.2809,2.2802,2.2976,2.2902,2.2976,2.2911,2.0211,2.0277,2.0198,2.3009,2.3113,2.3188,2.3205,2.3122,1.9877,1.9912,1.9753,1.9855,1.9988,2.3065,2.3087,2.3279,2.3311,2.3184,2.3291,2.3188,2.3234,2.3278,2.3297,2.3311,2.3329,2.3311,2.3356,2.3411,2.3487,2.351,2.3312,2.3452,2.4567,2.4638,2.4693,2.4501,2.4679,2.4783,2.4765,2.4829,2.49,2.4978,2.4989,2.5009,2.511,2.5187,2.5188,2.5123,2.5088,2.5099,2.51,2.5188,2.5132,2.519,2.5178];

                        $scope.info.line.startDate($scope.info.getStartDate(30));
                        $scope.info.line.yList($scope.info.randNum($scope.info.currTab));
                    } else {
                        //
                    }
                });

            }]
        }
    },
    resolve: {
        'detail': ['$ocLazyLoad', function($ocLazyLoad){
            return $ocLazyLoad.load({
                name: 'detail',
                serie: true,
                files: [
                    '../bower_components/highcharts/highcharts.js',
                    //'../bower_components/highcharts/highstock.src.js',
                    '../bower_components/highcharts/highcharts-more.js',
                    '../bower_components/highcharts-ng/dist/highcharts-ng.js',
                    'modules/trade/detail/index.js'
                ]
            })
        }]
    }
};